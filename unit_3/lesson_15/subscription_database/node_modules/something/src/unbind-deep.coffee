CALLBACK_KEY = require('./callback-key')

module.exports = unbindDeep = (keys, callback, obj = {}) ->
  prop = keys[0]

  if keys.length > 1
    obj[prop] = bindDeep(keys[1..], callback, obj[prop])
  else
    callbacks = obj[prop][CALLBACK_KEY]
    index = callbacks.indexOf(callback)
    callbacks.splice(index)

  obj
